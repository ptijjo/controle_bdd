// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

datasource db {
  provider = "postgres"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum Role {
  controleur
  chef_service
  controle
}

enum TypeLigne {
  LR
  SC
  SA
}

model User {
  id       String @id @default(cuid())
  email    String @unique
  password String
  nom      String
  role     Role   @default(controle)

  //Relations
  formControleur Form[] @relation("Controleur")

  Signature Signature[]
}

model Form {
  id           String   @id @default(cuid())
  dateControle DateTime @default(now())

  controleurId String //Contr√¥leur
  controleur   User   @relation("Controleur", fields: [controleurId], references: [id])

  numeroLigne String
  typeLigne   TypeLigne

  lieuControle String
  heurePrevue  DateTime
  heureReelle  DateTime
  secteur      String
  parc         Int
  nom          String
  prenom       String
  email        String   @unique

  ficheHoraire           Boolean?
  respectItineraire      Boolean?
  affichageDestination   Boolean?
  affichageNumeroLigne   Boolean?
  pictoEnfant            Boolean?
  tarifAffiche           Boolean?
  depliantHoraire        Boolean?
  reglement              Boolean?
  tenue                  Boolean?
  carosserie             Boolean?
  tableauBord            Boolean?
  sol                    Boolean?
  temperature            Boolean?
  luminosite             Boolean?
  nbreVoyageur           Int
  nbreVoyageurIrregulier Int

  observation String

  //Relation
  Signature Signature[]
}

model Signature {
  id     String @id @default(cuid())
  formId String
  form   Form   @relation(fields: [formId], references: [id])

  controleurId String?
  controleur   User?   @relation(fields: [controleurId], references: [id])

  signataireNom   String? //Pour le chauffeur externe
  base64 String
}
